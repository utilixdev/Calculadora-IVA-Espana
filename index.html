<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculadora de IVA España – 21% / 10% / 4%</title>
  <meta name="description" content="Calcula el IVA en España (21%, 10% o 4%) al instante. Introduce base imponible o precio con IVA y obtén el desglose. 100% gratis y sin registros." />
  <link rel="canonical" href="https://tusitio.example/calculadora-iva-espana" />
  <meta property="og:title" content="Calculadora de IVA España – 21% / 10% / 4%" />
  <meta property="og:description" content="Calcula el IVA en España al instante. Elige 21%, 10% o 4% y obtén el desglose completo. Gratis, rápido y sin registros." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://tusitio.example/og-iva.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <style>
    :root { --bg:#0b1220; --card:#121a2b; --fg:#eaf2ff; --muted:#9fb2d9; --accent:#60a5fa; --ok:#22c55e; }
    * { box-sizing: border-box; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; color: var(--fg); background: radial-gradient(1200px 800px at 20% -10%, #15203a, var(--bg)); }
    header { max-width: 980px; margin: 0 auto; padding: 24px 16px 0; }
    header h1 { font-size: clamp(1.6rem, 2.6vw, 2.4rem); margin: 6px 0; }
    header p { color: var(--muted); margin: 0 0 16px; }
    main { max-width: 980px; margin: 0 auto; padding: 16px; }
    .grid { display: grid; grid-template-columns: 1fr; gap: 16px; }
    @media (min-width: 900px) { .grid { grid-template-columns: 1fr 1fr; } }
    .card { background: linear-gradient(180deg, rgba(255,255,255,0.02), transparent 70%); border: 1px solid rgba(255,255,255,0.08); border-radius: 18px; padding: 18px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); backdrop-filter: blur(6px); }
    label { display: block; font-weight: 600; margin: 10px 0 6px; }
    input[type="number"] { width: 100%; padding: 12px 14px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.12); background: #0f172a; color: var(--fg); font-size: 16px; outline: none; }
    input[type="number"]:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(96,165,250,0.25); }
    .row { display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
    .rates { display: flex; gap: 10px; flex-wrap: wrap; }
    .chip { cursor: pointer; padding: 8px 12px; border-radius: 999px; border: 1px solid rgba(255,255,255,0.12); color: var(--fg); background: #0f172a; }
    .chip[aria-pressed="true"] { background: var(--accent); color: #061226; border-color: transparent; }
    .hint { color: var(--muted); font-size: 0.9rem; }
    .result { font-size: clamp(1.2rem, 2.2vw, 1.6rem); font-weight: 700; }
    .muted { color: var(--muted); }
    .kpi { display:grid; grid-template-columns: 1fr 1fr; gap:12px; margin-top: 10px; }
    .kpi div { padding: 12px; border-radius: 12px; background:#0f172a; border:1px solid rgba(255,255,255,0.07); }
    .cta { display:flex; gap:10px; flex-wrap: wrap; margin-top: 14px; }
    .btn { cursor: pointer; border: none; border-radius: 12px; padding: 12px 16px; font-weight: 600; background: var(--accent); color: #061226; }
    .btn.secondary { background: transparent; color: var(--fg); border: 1px solid rgba(255,255,255,0.18); }
    footer { max-width:980px; margin: 0 auto; padding: 32px 16px 64px; color: var(--muted); font-size: 0.9rem; }
    .legal { font-size: 0.8rem; opacity: 0.9; }
    .pill { display:inline-block; padding: 6px 10px; border-radius: 999px; background: rgba(34,197,94,0.15); color: #86efac; font-weight: 700; font-size: 0.75rem; letter-spacing: .4px; }
  </style>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Calculadora de IVA España",
    "url": "https://tusitio.example/calculadora-iva-espana",
    "applicationCategory": "BusinessApplication",
    "operatingSystem": "Web",
    "description": "Calcula el IVA en España (21%, 10% o 4%) al instante. Introduce base imponible o precio con IVA y obtén el desglose.",
    "offers": {"@type":"Offer", "price":"0", "priceCurrency":"EUR"}
  }
  </script>
</head>
<body>
  <header>
    <span class="pill">Gratis · Sin registros</span>
    <h1>Calculadora de IVA España</h1>
    <p>Introduce <strong>base imponible</strong> o <strong>precio con IVA</strong>, elige el tipo (21%, 10% o 4%) y obtén el desglose al instante.</p>
  </header>
  <main class="grid" role="main">
    <section class="card" aria-labelledby="calc-title">
      <h2 id="calc-title" style="margin:0 0 8px">Calcula tu IVA</h2>

      <div class="row" role="group" aria-label="Tipo de IVA">
        <span class="hint">Tipo de IVA:</span>
        <div class="rates" id="rates">
          <button class="chip" data-rate="21" aria-pressed="true">21%</button>
          <button class="chip" data-rate="10" aria-pressed="false">10%</button>
          <button class="chip" data-rate="4" aria-pressed="false">4%</button>
        </div>
      </div>

      <label for="base">Base imponible (€)</label>
      <input id="base" type="number" inputmode="decimal" min="0" step="0.01" placeholder="Ej. 100,00" />

      <label for="total">Precio con IVA (€)</label>
      <input id="total" type="number" inputmode="decimal" min="0" step="0.01" placeholder="Ej. 121,00" />
      <p class="hint">Rellena <em>uno</em> de los dos campos y el otro se calculará automáticamente.</p>

      <div class="kpi" aria-live="polite">
        <div>
          <div class="muted">IVA (€)</div>
          <div class="result" id="iva">—</div>
        </div>
        <div>
          <div class="muted">Total (€)</div>
          <div class="result" id="resTotal">—</div>
        </div>
      </div>

      <div class="cta">
        <button class="btn" id="copy">Copiar desglose</button>
        <button class="btn secondary" id="clear">Limpiar</button>
      </div>
    </section>

    <section class="card" aria-labelledby="help-title">
      <h2 id="help-title" style="margin:0 0 8px">Cómo funciona</h2>
      <p class="hint">Selecciona el tipo de IVA y escribe la <strong>base imponible</strong> <em>o</em> el <strong>precio final con IVA</strong>. La calculadora hará el resto.</p>
      <ul>
        <li>Tipos habituales en España: <strong>21%</strong> (general), <strong>10%</strong> (reducido) y <strong>4%</strong> (superreducido).</li>
        <li>Redondeo a dos decimales siguiendo reglas financieras.</li>
        <li>100% en tu navegador. No guardamos datos.</li>
      </ul>
      <hr style="border-color:rgba(255,255,255,0.08)" />
      <p class="hint">¿Te fue útil? Compártela:</p>
      <div class="row">
        <a class="btn secondary" id="share" href="#" rel="nofollow">Compartir</a>
        <a class="btn secondary" id="tweet" href="#" rel="nofollow">Twitter/X</a>
        <a class="btn secondary" id="wa" href="#" rel="nofollow">WhatsApp</a>
      </div>
    </section>
  </main>

  <footer>
    <p>© <span id="year"></span> Calculadora de IVA España · Hecho por <a href="#" style="color:#93c5fd; text-decoration: none;">utilixdev</a></p>
    <p class="legal">Aviso: esta herramienta es informativa; verifica con tu asesor para casos específicos.</p>
  </footer>

  <script>
    (function(){
      const rateChips = document.querySelectorAll('.chip');
      const base = document.getElementById('base');
      const total = document.getElementById('total');
      const ivaOut = document.getElementById('iva');
      const totalOut = document.getElementById('resTotal');
      const copyBtn = document.getElementById('copy');
      const clearBtn = document.getElementById('clear');
      const year = document.getElementById('year');
      year.textContent = new Date().getFullYear();

      let rate = 21; // default

      const setRate = (v) => {
        rate = Number(v);
        rateChips.forEach(c => c.setAttribute('aria-pressed', c.dataset.rate === String(rate)));
        compute();
      };

      rateChips.forEach(chip => chip.addEventListener('click', () => setRate(chip.dataset.rate)));

      const round2 = (n) => Math.round((n + Number.EPSILON) * 100) / 100;

      function compute(){
        const baseVal = parseFloat(base.value.replace(',', '.'));
        const totalVal = parseFloat(total.value.replace(',', '.'));
        let iva = NaN, tot = NaN;

        if (!isNaN(baseVal) && (total.value === '' || isNaN(totalVal))) {
          iva = baseVal * rate / 100;
          tot = baseVal + iva;
          total.value = isFinite(tot) ? round2(tot).toFixed(2) : '';
        } else if (!isNaN(totalVal) && (base.value === '' || isNaN(baseVal))) {
          const divisor = 1 + (rate/100);
          const b = totalVal / divisor;
          iva = totalVal - b;
          tot = totalVal;
          base.value = isFinite(b) ? round2(b).toFixed(2) : '';
        } else if (!isNaN(baseVal) && !isNaN(totalVal)) {
          // Si los dos están rellenos, recalcula total desde base para mantener coherencia
          iva = baseVal * rate / 100;
          tot = baseVal + iva;
          total.value = round2(tot).toFixed(2);
        } else {
          iva = NaN; tot = NaN;
        }
        ivaOut.textContent = isFinite(iva) ? round2(iva).toFixed(2) : '—';
        totalOut.textContent = isFinite(tot) ? round2(tot).toFixed(2) : '—';
      }

      base.addEventListener('input', () => { total.value = ''; compute(); });
      total.addEventListener('input', () => { base.value = ''; compute(); });

      copyBtn.addEventListener('click', async () => {
        const b = base.value || '—';
        const t = total.value || '—';
        const text = `Tipo IVA: ${rate}%\nBase: ${b} €\nIVA: ${ivaOut.textContent} €\nTotal: ${t} €`;
        try { await navigator.clipboard.writeText(text); copyBtn.textContent = '¡Copiado!'; setTimeout(()=>copyBtn.textContent='Copiar desglose',1200); } catch(e){ alert('Cópialo manualmente:\n' + text); }
      });

      clearBtn.addEventListener('click', () => {
        base.value = ''; total.value = ''; ivaOut.textContent = '—'; totalOut.textContent = '—';
      });

      // compartir
      function shareUrl(){ return location.href; }
      const shareBtn = document.getElementById('share');
      shareBtn.addEventListener('click', async (e)=>{
        e.preventDefault();
        const data = { title: 'Calculadora de IVA España', text: 'Calcula IVA 21%, 10% o 4% al instante', url: shareUrl() };
        if (navigator.share) { await navigator.share(data); } else { navigator.clipboard.writeText(shareUrl()); alert('Enlace copiado'); }
      });
      document.getElementById('tweet').href = `https://twitter.com/intent/tweet?text=${encodeURIComponent('Calcula IVA 21%, 10% o 4% al instante')}&url=${encodeURIComponent(shareUrl())}`;
      document.getElementById('wa').href = `https://wa.me/?text=${encodeURIComponent('Calcula IVA 21%, 10% o 4% al instante ' + shareUrl())}`;

      // iniciar
      compute();
    })();
  </script>
</body>
</html>
